var inputs=document.querySelectorAll("input[type=text]");inputs.forEach(function(e){e.onkeyup=function(){this.value=this.value.trim()}});var htmlHref=window.location.href,addr=(htmlHref=htmlHref.replace(/^http:\/\/[^/]+/,"")).substr(htmlHref.lastIndexOf("/",htmlHref.lastIndexOf("/")-1)+1),index=addr.lastIndexOf("/"),id=decodeURI(addr.substring(index+1,addr.length)),username=localStorage.getItem("username");function reply(i,c,o){$("#form").css("display","none"),$(".table form").css("display","none"),$("#"+i).show(),$("#"+i).on("submit",function(e){var t=$("#"+i+" input[type=text]").val(),n=$("#"+i+" .form-control").val(),a=$("#"+i+" select[name=face]").val();return new PostComment(c,t,a,n).replyData(o,i),e.preventDefault(),!1})}function PostComment(e,t,n,a){this.user_id=e||"",this.user_name=t.replace(/做爱|黄色|日|妈|操|gay|fuck/gi,"**"),this.face=n,this.time=(new Date).toLocaleString(),this.content=a.replace(/做爱|黄色|日|妈|操|gay|fuck/gi,"**")}function ajax(e,t,n,a){$.ajax({type:"POST",url:e,data:t,success:n,error:a})}username?$("#name").val(username):$("#name").val(""),$("#form").on("submit",function(e){var t=$("input[name=name]").val(),n=$("#form-control").val();return new PostComment(null,t,$("select[name=face]").val(),n).commentData(),e.preventDefault(),!1}),PostComment.prototype.validateData=function(){return!!this.content.replace(/ +/g,"").replace(/[\r\n]/g,"")||(alert("请输入内容！"),!1)},PostComment.prototype.commentData=function(){if(!this.validateData())return!1;var t=this;ajax("/article/"+id,{name:this.user_name,content:this.content,time:this.time,face:this.face},function(e){if(200!==e.status)return alert("非法错误！"),!1;localStorage.setItem("username",t.user_name),e='<tr><td><div class="touxiang"><img src="'.concat(e.message.face,'" alt="人物头像" width="50" height="50"><div>').concat(e.message.name,'</div></div><div class="content">').concat(e.message.content,"<br><small>").concat(e.message.time,"</small></div></td></tr>"),$(".toast").toast("show"),$(".table tbody").prepend(e),$("#form-control").val(""),$("input[name=name]").val("")})},PostComment.prototype.replyData=function(t,n){if(!this.validateData())return!1;var a=this;ajax("/reply?id="+a.user_id+"&blog_id="+id,{name:this.user_name,content:this.content,time:this.time,face:this.face,reply_name:t},function(e){if(200!==e.status)return alert("非法错误！"),!1;$("#"+a.user_id).parent().append('<div class="hf"><div class="reply_area"><span class="reply_info"><img src="'.concat(e.message.replyface,'" alt="人物头像" width="50" height="50"> <span>').concat(e.message.replyname,'<span class="text-info">&nbsp;回复&nbsp;</span><span></span>').concat(t,':</span></span><span class="reply_content">').concat(e.message.replycomment,"<br><small>").concat(e.message.replytime,"</small></span></div></div>")),$(".toast").toast("show"),$("#"+n+"reply").val(""),$("#"+n+"name").val(""),$("#"+n).hide()})},$(function(){var e,t;e=document.querySelector(".profile-image"),(t=new Image).src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t.onload=function(){0<t.width&&0<t.height||(e.src="/public/home/dev/images/win10狗头.jpg")},t.onerror=function(){e.src="/public/home/dev/images/win10狗头.jpg"},$("#config-trigger").click(function(e){e.preventDefault(),$(this).hasClass("config-panel-open")?($("#config-panel").animate({right:"-=190"},500),$(this).removeClass("config-panel-open").addClass("config-panel-hide")):($("#config-panel").animate({right:"+=190"},500),$(this).removeClass("config-panel-hide").addClass("config-panel-open"))}),$("#config-close").on("click",function(e){e.preventDefault(),$("#config-trigger").click()}),(-1!==location.href.indexOf("list")?$(".navbar-nav > .nav-item:nth-child(2)"):$(".navbar-nav > .nav-item:nth-child(1)")).addClass("active");var i,n=location.search;n&&-1!==n.indexOf("?search")&&(i=decodeURIComponent(n.split("?search=")[1]),0!==$(".title a").length?$(".title a").each(function(e,t){var n=$(t).html(),a=new RegExp(i,"gi"),n=n.match(a).reduce(function(e,t){return e.replace(t,'<mark class="highlightTitle">'+t+"</mark>")},n);$(t).html(n)}):$(".blog-list > .container").text("空空如也，世界变得清净了~"));var a=["#5ecca9","#3b7eeb","#eea73b","#6c51a4"],c=localStorage.getItem("color"),n=$("#color-options .list-inline-item");switch(n.click(function(){$(this).addClass("active").siblings().removeClass("active");var e=$(this).index(),e=a[e];$(".header").css("backgroundColor",e),$(".nav-link").css("backgroundColor",e),$(".more-link").css("color",e),$(".list-inline-item a").css("color",e),$(".btn-primary").css({backgroundColor:e,borderColor:e}),localStorage.setItem("color",e)}),c){case a[0]:n.eq(0).addClass("active");break;case a[1]:n.eq(1).addClass("active");break;case a[2]:n.eq(2).addClass("active");break;case a[3]:n.eq(3).addClass("active");break;default:n.eq(0).addClass("active")}var o=$(".logo");Array.prototype.slice.call(o.text()).reduce(function(e,t,n){e===n&&o.html("");n=document.createElement("span"),n=$(n);n.html(t),o.append(n),n.on("mouseover",function(){$(this).addClass("color")}),n.on("animationend",function(){$(this).removeClass("color")})},0);var s=$(window).height(),l=$(".top");$(document).on("scroll",function(){$(document).scrollTop()>=s/2?l.fadeIn():l.fadeOut()}),l.on("click",function(){$("body ,html").stop().animate({scrollTop:0})});var r={threshold:1,rootMargin:"0px"};function m(e,t){new IntersectionObserver(function(e,n){e.forEach(function(e){var t;e.isIntersecting&&(t=e.target,e=$(t).attr("data-src"),$(t).attr("src",e),n.disconnect())})},r).observe(t)}$(".item img").each(m),$("#inlineFormCustomSelect").on("change",function(){var e=$("#inlineFormCustomSelect option:checked").val(),a=$("#inlineFormCustomSelect option:checked").text();$.get("/ajax_list",{cid:e},function(e){var n;200===e.status&&0<e.message.length?(n=document.createDocumentFragment(),e.message.forEach(function(e){var t=$('<div class="item mb-5"></div>')[0];t.innerHTML='<div class="media">\n        <img\n          src="https://via.placeholder.com/110x110.png?text=shixtao.cn"\n          class="mr-3 img-fluid post-thumb d-none d-md-flex"\n          data-src="'.concat(e.img,'"\n        />\n        <div class="media-body">\n          <h2 class="title mb-1">\n            <a href="/article/').concat(e.id,'">').concat(e.title,'</a>\n          </h2>\n          <div class="meta mb-1">\n            <i class="iconfont icon-bokeyuan"></i>\n            <span title="博客类型"\n              >').concat(e.type,'&nbsp;\n              <span class="text-info">\n                ').concat(a,'\n              </span>\n            </span>\n            <i class="iconfont icon-shizhong"></i>\n            <span title="发表时间">').concat(e.time,'</span>\n            <i class="iconfont icon-renyuan"></i>\n            <span title="博客作者">').concat(e.author,'</span>\n            <i class="iconfont icon-pinglun"></i>\n            <span title="评论"\n              ><a href="/article/').concat(e.id,'#form"\n                >').concat(e.comment,' 评论</a\n              ></span\n            >\n            <i class="iconfont icon-liulan"></i>\n            <span title="浏览量">').concat(e.click,'</span>\n          </div>\n          <div class="intro">').concat(e.description,'</div>\n          <a class="more-link" href="/article/').concat(e.id,'"\n            >更多内容 &rarr;</a\n          >\n        </div>\n      </div>\n          '),n.appendChild(t)}),$(".blog-list > .container").html(n),$(".item img").each(m)):location.href="/list"})})});